<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Retro Apple Conversor</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap');
    body {
      font-family: 'Inter', sans-serif;
      background: #d1d5db;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 1rem;
      color: #1f2937;
      transition: background 0.3s, color 0.3s;
    }
    .calculator {
      background: #c0c0c0;
      border: 2px solid #808080;
      border-radius: 12px;
      box-shadow: 8px 8px 0 rgba(0,0,0,0.2);
      padding: 1.5rem;
      max-width: 400px;
      width: 100%;
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
      transition: background 0.3s, border 0.3s, box-shadow 0.3s;
    }
    .display-container, .conversion-input, .copy-button, .button {
      transition: background 0.3s, border 0.3s, color 0.3s;
    }
    .display-container {
      background: #fff;
      border: 2px solid #808080;
      border-radius: 8px;
      padding: 0.75rem 1rem;
    }
    .display {
      font-size: 2.5rem;
      text-align: right;
      background: none;
      border: none;
      outline: none;
      width: 100%;
      color: inherit;
    }
    .conversion-row {
      display: grid;
      grid-template-columns: 1fr 3fr auto;
      align-items: center;
      gap: 0.5rem;
    }
    .conversion-label {
      font-weight: bold;
      font-size: 0.875rem;
      text-align: right;
      padding-right: 0.5rem;
    }
    .conversion-input {
      background: #fff;
      border: 1px solid #a0a0a0;
      border-radius: 4px;
      padding: 0.5rem;
      font-size: 1rem;
      width: 100%;
      cursor: default;
    }
    .copy-button, .button {
      cursor: pointer;
      border-radius: 8px;
      font-weight: bold;
      user-select: none;
    }
    .copy-button, .button {
      background: #e0e0e0;
      border: 1px solid #a0a0a0;
      box-shadow: 2px 2px 0 rgba(0,0,0,0.2);
    }
    .copy-button:hover, .button:hover { background: #d0d0d0; }
    .button:active { transform: translate(2px,2px); box-shadow: none; }
    .button { font-size: 1.25rem; padding: 1rem 0; text-align: center; }
    .button.disabled { color: #d1d5db; cursor: not-allowed; }
    .button-special { background: #ffbd2e; border-color: #a08020; }
    .button-special-green { background: #27c93f; border-color: #1a8b2c; }
    .button-special-red { background: #ff5f56; border-color: #a63f3a; }
    .keypad { display: grid; grid-template-columns: repeat(4,1fr); gap: 0.75rem; }

    /* --- NUEVO BOT√ìN ESTILO MACINTOSH 1984 --- */
    .mode-toggle-button {
      position: fixed;
      top: 1rem;
      right: 1rem;
      background-color: #C0C0C0;
      border: 2px solid black;
      font-family: monospace;
      font-size: 24px;
      cursor: pointer;
      padding: 5px 30px;
      box-shadow: 2px 2px 0px #808080;
      transition: background-color 0.2s, box-shadow 0.2s;
    }
    .mode-toggle-button:active {
      box-shadow: 0px 0px 0px #808080;
      transform: translate(2px, 2px);
    }
    body.dark-mode .mode-toggle-button {
      background-color: #202020;
      border-color: #D8D8D8;
      color: #D8D8D8;
      box-shadow: 2px 2px 0px #404040;
    }
    body.dark-mode .mode-toggle-button:active {
      box-shadow: 0px 0px 0px #404040;
    }
    .icon-symbol { font-size: 24px; }

    /* --- Dark Mode del Conversor --- */
    body.dark-mode { background-color: #1a202c; color: #e2e8f0; }
    body.dark-mode .calculator { background-color: #2d3748; border-color: #4a5568; }
    body.dark-mode .display-container { background-color: #4a5568; border-color: #6a7c8e; }
    body.dark-mode .display { color: #e2e8f0; }
    body.dark-mode .conversion-label { color: #cbd5e0; }
    body.dark-mode .conversion-input { background-color: #4a5568; border-color: #6a7c8e; color: #e2e8f0; }
    body.dark-mode .copy-button { background-color: #4a5568; border-color: #6a7c8e; color: #e2e8f0; }
    body.dark-mode .copy-button:hover { background-color: #5b6b7d; }
    body.dark-mode .button { background-color: #4a5568; border-color: #6a7c8e; color: #e2e8f0; }
    body.dark-mode .button:hover { background-color: #5b6b7d; }
    body.dark-mode .button.disabled { color: #9fa6b2; }
    body.dark-mode .button-special { background: #ffbd2e; border-color: #a08020; color: #1f2937; }
    body.dark-mode .button-special-green { background: #27c93f; border-color: #1a8b2c; color: #1f2937; }
    body.dark-mode .button-special-red { background: #ff5f56; border-color: #a63f3a; color: #1f2937; }
  </style>
</head>
<body>
  <!-- NUEVO BOT√ìN MODO OSCURO -->
  <button id="modeToggleButton" class="mode-toggle-button" aria-label="Cambiar modo de tema">
    <span class="icon-symbol">‚òÄÔ∏è</span>
  </button>

  <div class="calculator">
    <div class="display-container"><input type="text" id="display" class="display" value="0" readonly></div>
    <div class="conversions-container">
      <div class="conversion-row"><span class="conversion-label">DEC</span><input id="dec" class="conversion-input" value="0" readonly><button class="copy-button" onclick="copyToClipboard('dec')">üìã</button></div>
      <div class="conversion-row"><span class="conversion-label">BIN</span><input id="bin" class="conversion-input" value="0" readonly><button class="copy-button" onclick="copyToClipboard('bin')">üìã</button></div>
      <div class="conversion-row"><span class="conversion-label">HEX</span><input id="hex" class="conversion-input" value="0" readonly><button class="copy-button" onclick="copyToClipboard('hex')">üìã</button></div>
      <div class="conversion-row"><span class="conversion-label">OCT</span><input id="oct" class="conversion-input" value="0" readonly><button class="copy-button" onclick="copyToClipboard('oct')">üìã</button></div>
    </div>
    <div class="keypad">
      <button class="button" data-value="7">7</button><button class="button" data-value="8">8</button><button class="button" data-value="9">9</button><button class="button button-special" data-op="√∑">√∑</button>
      <button class="button" data-value="4">4</button><button class="button" data-value="5">5</button><button class="button" data-value="6">6</button><button class="button button-special" data-op="x">x</button>
      <button class="button" data-value="1">1</button><button class="button" data-value="2">2</button><button class="button" data-value="3">3</button><button class="button button-special" data-op="-">-</button>
      <button class="button" data-value="A">A</button><button class="button" data-value="B">B</button><button class="button" data-value="C">C</button><button class="button button-special" data-op="+">+</button>
      <button class="button" data-value="D">D</button><button class="button" data-value="E">E</button><button class="button" data-value="F">F</button><button class="button button-special-green" data-op="=">=</button>
      <button class="button" data-value="0">0</button><button class="button" data-value=".">.</button><button class="button" data-op="backspace">DEL</button><button class="button button-special-red" data-op="clear">AC</button>
    </div>
  </div>

  <script>
    const display = document.getElementById('display');
    const inputs = { dec:10, bin:2, hex:16, oct:8 };
    const buttons = document.querySelectorAll('.button');
    let currentInput = '0', operator=null, prevValue=null, base=10;
    const hexLetters = ['A','B','C','D','E','F'];

    function updateConversions() {
      const decimal = parseInt(currentInput, base) || 0;
      for (let id in inputs) {
        document.getElementById(id).value = isNaN(decimal) ? 'Error' : decimal.toString(inputs[id]).toUpperCase();
      }
    }
    function copyToClipboard(id) {
      navigator.clipboard.writeText(document.getElementById(id).value);
    }
    function updateButtonState() {
      buttons.forEach(btn=>{
        const v=btn.dataset.value;
        if(!v) return;
        btn.classList.remove('disabled');
        if(base===2 && (/[2-9A-F.]/.test(v))) btn.classList.add('disabled');
        if(base===8 && (/[89A-F.]/.test(v))) btn.classList.add('disabled');
        if(base===10 && hexLetters.includes(v)) btn.classList.add('disabled');
      });
    }
    buttons.forEach(btn=>{
      btn.addEventListener('click',()=>{
        if(btn.classList.contains('disabled')) return;
        const v=btn.dataset.value, op=btn.dataset.op;
        if(v){
          currentInput=(currentInput==='0'||prevValue!==null)?v:currentInput+v;
          prevValue=null;
        }else if(op){
          if(op==='clear'){ currentInput='0'; prevValue=null; operator=null; }
          else if(op==='backspace'){ currentInput=currentInput.length>1?currentInput.slice(0,-1):'0'; }
          else if(op==='='){
            if(operator&&prevValue!==null){
              const a=parseInt(prevValue,base), b=parseInt(currentInput,base);
              if(isNaN(a)||isNaN(b)) return display.value='Error';
              let r={'+':a+b,'-':a-b,'x':a*b,'√∑':a/b}[operator];
              currentInput=r.toString(base); operator=null; prevValue=null;
            }
          }else{ prevValue=currentInput; operator=op; currentInput='0'; }
        }
        display.value=currentInput; updateConversions();
      });
    });
    for(let id in inputs){ document.getElementById(id).addEventListener('click',()=>{ base=inputs[id]; updateButtonState(); }); }

    // --- NUEVA L√ìGICA BOT√ìN MACINTOSH ---
    const modeToggleButton = document.getElementById('modeToggleButton');
    const iconSymbol = modeToggleButton.querySelector('.icon-symbol');
    let isDarkMode = false;
    const sunSymbol = '‚òÄÔ∏è';
    const moonSymbol = 'üåë';

    modeToggleButton.addEventListener('click', () => {
      isDarkMode = !isDarkMode;
      if (isDarkMode) {
        document.body.classList.add('dark-mode');
        iconSymbol.textContent = moonSymbol;
      } else {
        document.body.classList.remove('dark-mode');
        iconSymbol.textContent = sunSymbol;
      }
    });

    updateButtonState(); updateConversions();
  </script>
</body>
</html>
